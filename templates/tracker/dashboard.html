{% extends 'tracker/base.html' %}

{% block content %}

<div class="hero">
    <div class="hero-text">
        <h1>Manage Your Job Applications Smartly üöÄ</h1>
        <p>Track jobs, interviews, follow-ups and notes ‚Äî all in one place.</p>
        <a href="{% url 'add_job' %}" class="btn">+ Add New Job</a>
    </div>
    <div class="hero-img">
        <img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d" alt="Job tracking">
    </div>
</div>

<div class="stats">
    <div class="card">
        <h3>{{ total }}</h3>
      <p>Total Applications</p>

    </div>
    <div class="card">
        <h3>{{ interviews }}</h3>
        <p>Interviews</p>
    </div>
    <div class="card">
        <h3>{{ rejected }}</h3>
        <p>Rejected</p>
    </div>
</div>



<style>
.hero {
    display: flex;
    align-items: center;
    gap: 40px;
}
.hero-text {
    flex: 1;
}
.hero-text h1 {
    font-size: 36px;
}
.hero-text p {
    font-size: 18px;
    color: #475569;
}
.btn {
    display: inline-block;
    margin-top: 15px;
    padding: 12px 20px;
    background: #38bdf8;
    color: black;
    text-decoration: none;
    border-radius: 6px;
}
.hero-img img {
    width: 420px;
    border-radius: 10px;
}

.stats {
    display: flex;
    gap: 20px;
    margin-top: 50px;
}
.card {
    background: white;
    padding: 20px;
    border-radius: 10px;
    width: 200px;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.card h3 {
    font-size: 30px;
    margin: 0;
    color: #38bdf8;
}

.badge {
    padding: 6px 12px;
    border-radius: 20px;
    color: white;
    font-size: 14px;
}
.Applied { background: #0ea5e9; }
.Interview { background: #22c55e; }
.Rejected { background: #ef4444; }

</style>

<h2>Your Applications</h2>

<form method="get" style="margin-bottom:20px;">
  <input type="text" name="q" placeholder="Search company or role..."
         value="{{ query }}" style="padding:10px;width:250px;">
  <button>Search</button>
</form>
<a href="?status=Applied">Applied</a> |
<a href="?status=Interview">Interview</a> |
<a href="?status=Rejected">Rejected</a>
<a href="/dashboard/">All</a>

<table style="
width:100%;
border-collapse:collapse;
background:white;
border-radius:10px;
overflow:hidden;"
 width="100%" border="1" cellpadding="10">
<tr>
<th style="background:#1f2937;color:white;">Company</th>
    <th>Role</th>
    <th>Status</th>
    <th>Follow-up</th>
    <th>Edit & Delete</th>
</tr>

{% for job in jobs %}
<tr>
    <td>{{ job.company }}</td>
    <td>{{ job.role }}</td>
    <td><span class="badge {{ job.status }}">{{ job.status }}</span></td>
<td
{% if job.followup_date and job.followup_date <= today %}
 style="background:#fee2e2;"
{% endif %}
>
{{ job.followup_date }}
</td>
    <td><a href="{% url 'edit_job' job.id %}">‚úèÔ∏è Edit</a> | <a href="{% url 'delete_job' job.id %}">üóëÔ∏è Delete</a></td>

</tr>
{% empty %}
<tr><td colspan="4">No applications yet</td></tr>
{% endfor %}
</table>

<h2>Application Stats</h2>
<canvas id="jobChart" width="400"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
window.onload = function() {
    const ctx = document.getElementById('jobChart').getContext('2d');
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Applied', 'Interview', 'Rejected'],
            datasets: [{
                data: [{{ total|default:0 }}, {{ interviews|default:0 }}, {{ rejected|default:0 }}],
                backgroundColor: ['#0ea5e9', '#22c55e', '#ef4444'],
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom',
                }
            }
        }
    });
};
</script>


{% endblock %}
